-- Leliks Rivals Script v1.0.9

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- Create ScreenGui
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local UICorner = Instance.new("UICorner")
local TitleLabel = Instance.new("TextLabel")
local VersionLabel = Instance.new("TextLabel")
local KeybindLabel = Instance.new("TextLabel")

-- Sidebar
local Sidebar = Instance.new("Frame")
local SidebarCorner = Instance.new("UICorner")
local SidebarList = Instance.new("UIListLayout")

-- Content Frame
local ContentFrame = Instance.new("Frame")
local ContentCorner = Instance.new("UICorner")

-- ScreenGui Settings
ScreenGui.Name = "LeliksRivalsGUI"
ScreenGui.Parent = game.CoreGui
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.ResetOnSpawn = false

-- Main Frame
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.5, -400, 0.5, -225)
MainFrame.Size = UDim2.new(0, 800, 0, 450)
MainFrame.Active = true
MainFrame.Draggable = true
MainFrame.Visible = true

UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = MainFrame

-- Title
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = MainFrame
TitleLabel.BackgroundTransparency = 1
TitleLabel.Position = UDim2.new(0, 0, 0, 10)
TitleLabel.Size = UDim2.new(1, 0, 0, 40)
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Text = "Leliks Rivals Script"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 26

-- Version Label (Bottom Left)
VersionLabel.Name = "VersionLabel"
VersionLabel.Parent = MainFrame
VersionLabel.BackgroundTransparency = 1
VersionLabel.Position = UDim2.new(0, 10, 1, -30)
VersionLabel.Size = UDim2.new(0, 70, 0, 20)
VersionLabel.Font = Enum.Font.GothamBold
VersionLabel.Text = "v1.0.9"
VersionLabel.TextColor3 = Color3.fromRGB(100, 100, 100)
VersionLabel.TextSize = 14
VersionLabel.TextTransparency = 0.3
VersionLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Keybind Info Label (Bottom Right)
KeybindLabel.Name = "KeybindLabel"
KeybindLabel.Parent = MainFrame
KeybindLabel.BackgroundTransparency = 1
KeybindLabel.Position = UDim2.new(1, -220, 1, -30)
KeybindLabel.Size = UDim2.new(0, 210, 0, 20)
KeybindLabel.Font = Enum.Font.GothamBold
KeybindLabel.Text = 'Can Open/Close with "Z"'
KeybindLabel.TextColor3 = Color3.fromRGB(100, 100, 100)
KeybindLabel.TextSize = 14
KeybindLabel.TextTransparency = 0.3
KeybindLabel.TextXAlignment = Enum.TextXAlignment.Right

-- Sidebar
Sidebar.Name = "Sidebar"
Sidebar.Parent = MainFrame
Sidebar.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
Sidebar.Position = UDim2.new(0, 10, 0, 60)
Sidebar.Size = UDim2.new(0, 180, 1, -100)
Sidebar.BorderSizePixel = 0

SidebarCorner.CornerRadius = UDim.new(0, 10)
SidebarCorner.Parent = Sidebar

SidebarList.Parent = Sidebar
SidebarList.SortOrder = Enum.SortOrder.LayoutOrder
SidebarList.Padding = UDim.new(0, 8)
SidebarList.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Content Frame
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 10)
ContentFrame.Position = UDim2.new(0, 200, 0, 60)
ContentFrame.Size = UDim2.new(1, -230, 1, -100)
ContentFrame.BorderSizePixel = 0

ContentCorner.CornerRadius = UDim.new(0, 10)
ContentCorner.Parent = ContentFrame

-- Close Button
local CloseButton = Instance.new("TextButton")
local CloseCorner = Instance.new("UICorner")

CloseButton.Name = "CloseButton"
CloseButton.Parent = MainFrame
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseButton.Position = UDim2.new(1, -45, 0, 15)
CloseButton.Size = UDim2.new(0, 35, 0, 35)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 20
CloseButton.BorderSizePixel = 0

CloseCorner.CornerRadius = UDim.new(0, 8)
CloseCorner.Parent = CloseButton

CloseButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
end)

-- Tab Button Creation Function
local currentTab = nil

local function CreateTabButton(name, text, order)
    local Button = Instance.new("TextButton")
    local ButtonCorner = Instance.new("UICorner")
    
    Button.Name = name
    Button.Parent = Sidebar
    Button.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Button.Size = UDim2.new(0, 160, 0, 45)
    Button.Font = Enum.Font.GothamBold
    Button.Text = text
    Button.TextColor3 = Color3.fromRGB(200, 200, 200)
    Button.TextSize = 16
    Button.AutoButtonColor = false
    Button.BorderSizePixel = 0
    Button.LayoutOrder = order
    
    ButtonCorner.CornerRadius = UDim.new(0, 8)
    ButtonCorner.Parent = Button
    
    Button.MouseEnter:Connect(function()
        if currentTab ~= name then
            Button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
        end
    end)
    
    Button.MouseLeave:Connect(function()
        if currentTab ~= name then
            Button.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        end
    end)
    
    return Button
end

-- Feature Button Creation Function
local function CreateFeatureButton(parent, name, text, callback)
    local Button = Instance.new("TextButton")
    local ButtonCorner = Instance.new("UICorner")
    local ButtonStroke = Instance.new("UIStroke")
    
    Button.Name = name
    Button.Parent = parent
    Button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    Button.Size = UDim2.new(1, 0, 0, 45)
    Button.Font = Enum.Font.GothamBold
    Button.Text = text
    Button.TextColor3 = Color3.fromRGB(255, 255, 255)
    Button.TextSize = 16
    Button.AutoButtonColor = false
    Button.BorderSizePixel = 0
    
    ButtonCorner.CornerRadius = UDim.new(0, 8)
    ButtonCorner.Parent = Button
    
    ButtonStroke.Color = Color3.fromRGB(70, 130, 255)
    ButtonStroke.Thickness = 2
    ButtonStroke.Parent = Button
    
    Button.MouseEnter:Connect(function()
        Button.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    end)
    
    Button.MouseLeave:Connect(function()
        Button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    end)
    
    Button.MouseButton1Click:Connect(callback)
    
    return Button
end

-- Create Tab Frames
local UpdatesFrame = Instance.new("ScrollingFrame")
UpdatesFrame.Name = "UpdatesFrame"
UpdatesFrame.Parent = ContentFrame
UpdatesFrame.BackgroundTransparency = 1
UpdatesFrame.Position = UDim2.new(0, 10, 0, 10)
UpdatesFrame.Size = UDim2.new(1, -20, 1, -20)
UpdatesFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
UpdatesFrame.ScrollBarThickness = 6
UpdatesFrame.ScrollBarImageColor3 = Color3.fromRGB(70, 130, 255)
UpdatesFrame.BorderSizePixel = 0
UpdatesFrame.Visible = false

local FeaturesFrame = Instance.new("ScrollingFrame")
FeaturesFrame.Name = "FeaturesFrame"
FeaturesFrame.Parent = ContentFrame
FeaturesFrame.BackgroundTransparency = 1
FeaturesFrame.Position = UDim2.new(0, 10, 0, 10)
FeaturesFrame.Size = UDim2.new(1, -20, 1, -20)
FeaturesFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
FeaturesFrame.ScrollBarThickness = 6
FeaturesFrame.ScrollBarImageColor3 = Color3.fromRGB(70, 130, 255)
FeaturesFrame.BorderSizePixel = 0
FeaturesFrame.Visible = false

local UpdatesList = Instance.new("UIListLayout")
UpdatesList.Parent = UpdatesFrame
UpdatesList.SortOrder = Enum.SortOrder.LayoutOrder
UpdatesList.Padding = UDim.new(0, 10)

local FeaturesList = Instance.new("UIListLayout")
FeaturesList.Parent = FeaturesFrame
FeaturesList.SortOrder = Enum.SortOrder.LayoutOrder
FeaturesList.Padding = UDim.new(0, 10)

-- Tab Switching Function
local function SwitchTab(tabName)
    currentTab = tabName
    
    UpdatesFrame.Visible = false
    FeaturesFrame.Visible = false
    
    for _, child in pairs(Sidebar:GetChildren()) do
        if child:IsA("TextButton") then
            if child.Name == tabName then
                child.BackgroundColor3 = Color3.fromRGB(70, 130, 255)
                child.TextColor3 = Color3.fromRGB(255, 255, 255)
            else
                child.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
                child.TextColor3 = Color3.fromRGB(200, 200, 200)
            end
        end
    end
    
    if tabName == "UpdatesTab" then
        UpdatesFrame.Visible = true
    elseif tabName == "FeaturesTab" then
        FeaturesFrame.Visible = true
    end
end

-- Create Tab Buttons
local UpdatesTab = CreateTabButton("UpdatesTab", "Updates", 1)
local FeaturesTab = CreateTabButton("FeaturesTab", "Features", 2)

UpdatesTab.MouseButton1Click:Connect(function()
    SwitchTab("UpdatesTab")
end)

FeaturesTab.MouseButton1Click:Connect(function()
    SwitchTab("FeaturesTab")
end)

-- Create Updates Content
local function CreateUpdateText(text, order)
    local Label = Instance.new("TextLabel")
    Label.Parent = UpdatesFrame
    Label.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    Label.Size = UDim2.new(1, 0, 0, 0)
    Label.Font = Enum.Font.Gotham
    Label.Text = text
    Label.TextColor3 = Color3.fromRGB(255, 255, 255)
    Label.TextSize = 14
    Label.TextWrapped = true
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.TextYAlignment = Enum.TextYAlignment.Top
    Label.BorderSizePixel = 0
    Label.LayoutOrder = order
    Label.AutomaticSize = Enum.AutomaticSize.Y
    
    local Padding = Instance.new("UIPadding")
    Padding.Parent = Label
    Padding.PaddingLeft = UDim.new(0, 10)
    Padding.PaddingRight = UDim.new(0, 10)
    Padding.PaddingTop = UDim.new(0, 10)
    Padding.PaddingBottom = UDim.new(0, 10)
    
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 8)
    Corner.Parent = Label
    
    return Label
end

CreateUpdateText("âœ… ALL FEATURES:\n\nâ€¢ ESP - See all players through walls with names\nâ€¢ Aimbot - Auto-aim to closest player (L key)\nâ€¢ Speed Boost - Move faster\nâ€¢ Infinite Jump - Jump infinitely\nâ€¢ No Recoil - Remove weapon recoil\nâ€¢ Wallhack - See through walls\nâ€¢ Silent Aim - Hidden aimbot\nâ€¢ Auto Headshot - Always aim for head\nâ€¢ Fly - Fly around the map\nâ€¢ NoClip - Walk through walls\nâ€¢ XRay - See through all parts\nâ€¢ Instant Respawn - Respawn immediately\nâ€¢ Teleport to Enemy - TP to nearest enemy\nâ€¢ Anti-Kick - Prevent kicks", 1)

CreateUpdateText("ðŸ†• LATEST UPDATES (v1.0.9):\n\nâ€¢ FIXED: Speed Boost now works properly\nâ€¢ NEW: NoClip - Walk through walls and objects\nâ€¢ NEW: XRay - See through all map parts\nâ€¢ Added keybind info display (Z key)\nâ€¢ Improved speed persistence across rounds\nâ€¢ Better UI layout with repositioned labels\nâ€¢ All features persist across rounds\nâ€¢ Performance improvements", 2)

-- Variables
local ESPEnabled = false
local ESPConnections = {}
local AimbotEnabled = false
local AimbotConnection = nil
local SpeedEnabled = false
local SpeedConnection = nil
local OriginalSpeed = 16
local InfiniteJumpEnabled = false
local JumpConnection = nil
local NoRecoilEnabled = false
local WallhackEnabled = false
local SilentAimEnabled = false
local AutoHeadshotEnabled = false
local FlyEnabled = false
local FlyConnection = nil
local FlyBodyVelocity = nil
local AntiKickEnabled = false
local NoClipEnabled = false
local NoClipConnection = nil
local XRayEnabled = false
local XRayParts = {}

-- Team Check Function
local function IsEnemy(player)
    if not player or player == LocalPlayer then 
        return false 
    end
    
    if LocalPlayer.Team and player.Team then
        return LocalPlayer.Team ~= player.Team
    end
    
    return true
end

-- ESP WITH NAMES
local function CreateESPForCharacter(player, character)
    if player == LocalPlayer then return end
    if not character then return end
    
    local oldHighlight = character:FindFirstChild("ESPHighlight")
    local oldBillboard = character:FindFirstChild("ESPNameTag")
    if oldHighlight then oldHighlight:Destroy() end
    if oldBillboard then oldBillboard:Destroy() end
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "ESPHighlight"
    highlight.Adornee = character
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    
    if IsEnemy(player) then
        highlight.FillColor = Color3.fromRGB(255, 0, 0)
    else
        highlight.FillColor = Color3.fromRGB(0, 255, 0)
    end
    
    highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
    highlight.FillTransparency = 0.5
    highlight.OutlineTransparency = 0
    highlight.Parent = character
    
    local head = character:FindFirstChild("Head")
    if head then
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "ESPNameTag"
        billboard.Adornee = head
        billboard.Size = UDim2.new(0, 200, 0, 50)
        billboard.StudsOffset = Vector3.new(0, 3, 0)
        billboard.AlwaysOnTop = true
        billboard.Parent = character
        
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Parent = billboard
        nameLabel.Size = UDim2.new(1, 0, 1, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = player.Name
        nameLabel.Font = Enum.Font.GothamBold
        nameLabel.TextSize = 16
        nameLabel.TextColor3 = IsEnemy(player) and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(0, 255, 0)
        nameLabel.TextStrokeTransparency = 0
        nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    end
end

local function SetupESPForPlayer(player)
    if player == LocalPlayer then return end
    
    if player.Character then
        CreateESPForCharacter(player, player.Character)
    end
    
    player.CharacterAdded:Connect(function(character)
        if ESPEnabled then
            task.wait(0.5)
            CreateESPForCharacter(player, character)
        end
    end)
end

local function RemoveESPFromCharacter(character)
    if not character then return end
    
    local highlight = character:FindFirstChild("ESPHighlight")
    local billboard = character:FindFirstChild("ESPNameTag")
    
    if highlight then highlight:Destroy() end
    if billboard then billboard:Destroy() end
end

local function RemoveAllESP()
    for _, player in pairs(Players:GetPlayers()) do
        if player.Character then
            RemoveESPFromCharacter(player.Character)
        end
    end
end

-- ESP Button
CreateFeatureButton(FeaturesFrame, "ESPButton", "ESP [OFF]", function()
    ESPEnabled = not ESPEnabled
    local button = FeaturesFrame:FindFirstChild("ESPButton")
    
    if ESPEnabled then
        button.Text = "ESP [ON]"
        
        for _, player in pairs(Players:GetPlayers()) do
            SetupESPForPlayer(player)
        end
        
        ESPConnections.PlayerAdded = Players.PlayerAdded:Connect(function(player)
            if ESPEnabled then
                SetupESPForPlayer(player)
            end
        end)
        
        ESPConnections.PlayerRemoving = Players.PlayerRemoving:Connect(function(player)
            if player.Character then
                RemoveESPFromCharacter(player.Character)
            end
        end)
    else
        button.Text = "ESP [OFF]"
        RemoveAllESP()
        
        if ESPConnections.PlayerAdded then
            ESPConnections.PlayerAdded:Disconnect()
        end
        if ESPConnections.PlayerRemoving then
            ESPConnections.PlayerRemoving:Disconnect()
        end
    end
end)

-- Aimbot Function
local function GetClosestPlayer()
    local closestPlayer = nil
    local shortestDistance = math.huge
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local head = player.Character:FindFirstChild("Head")
            local humanoid = player.Character:FindFirstChild("Humanoid")
            
            if head and humanoid and humanoid.Health > 0 then
                if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Head") then
                    local distance = (head.Position - LocalPlayer.Character.Head.Position).Magnitude
                    
                    if distance < shortestDistance and distance < 500 then
                        closestPlayer = player
                        shortestDistance = distance
                    end
                end
            end
        end
    end
    
    return closestPlayer
end

local function EnableAimbot()
    if AimbotConnection then
        AimbotConnection:Disconnect()
    end
    
    AimbotConnection = RunService.RenderStepped:Connect(function()
        if not AimbotEnabled then return end
        
        if not LocalPlayer.Character then return end
        if not LocalPlayer.Character:FindFirstChild("Head") then return end
        
        local target = GetClosestPlayer()
        
        if target then
            local targetChar = target.Character
            if targetChar then
                local targetHead = targetChar:FindFirstChild("Head")
                
                if targetHead then
                    local camera = workspace.CurrentCamera
                    if camera then
                        camera.CFrame = CFrame.new(camera.CFrame.Position, targetHead.Position)
                    end
                end
            end
        end
    end)
end

local function DisableAimbot()
    if AimbotConnection then
        AimbotConnection:Disconnect()
        AimbotConnection = nil
    end
end

-- Aimbot Button
CreateFeatureButton(FeaturesFrame, "AimbotButton", "Aimbot [OFF] - L key", function()
    AimbotEnabled = not AimbotEnabled
    local button = FeaturesFrame:FindFirstChild("AimbotButton")
    
    if AimbotEnabled then
        button.Text = "Aimbot [ON] - L key"
        EnableAimbot()
    else
        button.Text = "Aimbot [OFF] - L key"
        DisableAimbot()
    end
end)

-- FIXED SPEED BOOST
local function EnableSpeed()
    if SpeedConnection then
        SpeedConnection:Disconnect()
    end
    
    SpeedConnection = RunService.Heartbeat:Connect(function()
        if not SpeedEnabled then return end
        
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.WalkSpeed = 50
        end
    end)
end

local function DisableSpeed()
    if SpeedConnection then
        SpeedConnection:Disconnect()
        SpeedConnection = nil
    end
    
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        LocalPlayer.Character.Humanoid.WalkSpeed = 16
    end
end

CreateFeatureButton(FeaturesFrame, "SpeedButton", "Speed Boost [OFF]", function()
    SpeedEnabled = not SpeedEnabled
    local button = FeaturesFrame:FindFirstChild("SpeedButton")
    
    if SpeedEnabled then
        button.Text = "Speed Boost [ON]"
        EnableSpeed()
    else
        button.Text = "Speed Boost [OFF]"
        DisableSpeed()
    end
end)

-- Infinite Jump
CreateFeatureButton(FeaturesFrame, "JumpButton", "Infinite Jump [OFF]", function()
    InfiniteJumpEnabled = not InfiniteJumpEnabled
    local button = FeaturesFrame:FindFirstChild("JumpButton")
    button.Text = InfiniteJumpEnabled and "Infinite Jump [ON]" or "Infinite Jump [OFF]"
    
    if InfiniteJumpEnabled then
        JumpConnection = UserInputService.JumpRequest:Connect(function()
            if InfiniteJumpEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
                LocalPlayer.Character:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
            end
        end)
    else
        if JumpConnection then
            JumpConnection:Disconnect()
        end
    end
end)

-- No Recoil
CreateFeatureButton(FeaturesFrame, "RecoilButton", "No Recoil [OFF]", function()
    NoRecoilEnabled = not NoRecoilEnabled
    local button = FeaturesFrame:FindFirstChild("RecoilButton")
    button.Text = NoRecoilEnabled and "No Recoil [ON]" or "No Recoil [OFF]"
end)

-- Wallhack
CreateFeatureButton(FeaturesFrame, "WallhackButton", "Wallhack [OFF]", function()
    WallhackEnabled = not WallhackEnabled
    local button = FeaturesFrame:FindFirstChild("WallhackButton")
    button.Text = WallhackEnabled and "Wallhack [ON]" or "Wallhack [OFF]"
    
    for _, part in pairs(workspace:GetDescendants()) do
        if part:IsA("BasePart") and (part.Name == "Wall" or part.Name == "wall") then
            part.Transparency = WallhackEnabled and 0.7 or 0
        end
    end
end)

-- Silent Aim
CreateFeatureButton(FeaturesFrame, "SilentAimButton", "Silent Aim [OFF]", function()
    SilentAimEnabled = not SilentAimEnabled
    local button = FeaturesFrame:FindFirstChild("SilentAimButton")
    button.Text = SilentAimEnabled and "Silent Aim [ON]" or "Silent Aim [OFF]"
end)

-- Auto Headshot
CreateFeatureButton(FeaturesFrame, "HeadshotButton", "Auto Headshot [OFF]", function()
    AutoHeadshotEnabled = not AutoHeadshotEnabled
    local button = FeaturesFrame:FindFirstChild("HeadshotButton")
    button.Text = AutoHeadshotEnabled and "Auto Headshot [ON]" or "Auto Headshot [OFF]"
end)

-- FLY
local function EnableFly()
    if not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        return
    end
    
    local hrp = LocalPlayer.Character.HumanoidRootPart
    
    if FlyBodyVelocity then
        FlyBodyVelocity:Destroy()
    end
    
    FlyBodyVelocity = Instance.new("BodyVelocity")
    FlyBodyVelocity.Name = "FlyVelocity"
    FlyBodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    FlyBodyVelocity.Velocity = Vector3.new(0, 0, 0)
    FlyBodyVelocity.Parent = hrp
    
    if FlyConnection then
        FlyConnection:Disconnect()
    end
    
    FlyConnection = RunService.Heartbeat:Connect(function()
        if not FlyEnabled then return end
        
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local speed = 2
            local direction = Vector3.new(0, 0, 0)
            
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                direction = direction + workspace.CurrentCamera.CFrame.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                direction = direction - workspace.CurrentCamera.CFrame.LookVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                direction = direction - workspace.CurrentCamera.CFrame.RightVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                direction = direction + workspace.CurrentCamera.CFrame.RightVector
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                direction = direction + Vector3.new(0, 1, 0)
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
                direction = direction - Vector3.new(0, 1, 0)
            end
            
            if FlyBodyVelocity and FlyBodyVelocity.Parent then
                FlyBodyVelocity.Velocity = direction * speed * 50
            else
                EnableFly()
            end
        else
            task.wait(0.5)
            if FlyEnabled then
                EnableFly()
            end
        end
    end)
end

local function DisableFly()
    if FlyConnection then
        FlyConnection:Disconnect()
        FlyConnection = nil
    end
    
    if FlyBodyVelocity then
        FlyBodyVelocity:Destroy()
        FlyBodyVelocity = nil
    end
    
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local bv = LocalPlayer.Character.HumanoidRootPart:FindFirstChild("FlyVelocity")
        if bv then
            bv:Destroy()
        end
    end
end

CreateFeatureButton(FeaturesFrame, "FlyButton", "Fly [OFF]", function()
    FlyEnabled = not FlyEnabled
    local button = FeaturesFrame:FindFirstChild("FlyButton")
    button.Text = FlyEnabled and "Fly [ON]" or "Fly [OFF]"
    
    if FlyEnabled then
        EnableFly()
    else
        DisableFly()
    end
end)

-- NOCLIP
local function EnableNoClip()
    if NoClipConnection then
        NoClipConnection:Disconnect()
    end
    
    NoClipConnection = RunService.Stepped:Connect(function()
        if not NoClipEnabled then return end
        
        if LocalPlayer.Character then
            for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
end

local function DisableNoClip()
    if NoClipConnection then
        NoClipConnection:Disconnect()
        NoClipConnection = nil
    end
    
    if LocalPlayer.Character then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = true
            end
        end
    end
end

CreateFeatureButton(FeaturesFrame, "NoClipButton", "NoClip [OFF]", function()
    NoClipEnabled = not NoClipEnabled
    local button = FeaturesFrame:FindFirstChild("NoClipButton")
    button.Text = NoClipEnabled and "NoClip [ON]" or "NoClip [OFF]"
    
    if NoClipEnabled then
        EnableNoClip()
    else
        DisableNoClip()
    end
end)

-- XRAY
local function EnableXRay()
    XRayParts = {}
    
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("BasePart") and obj.Transparency < 1 then
            if not obj.Parent:FindFirstChild("Humanoid") then
                table.insert(XRayParts, {
                    Part = obj,
                    OriginalTransparency = obj.Transparency
                })
                obj.Transparency = 0.7
            end
        end
    end
end

local function DisableXRay()
    for _, data in pairs(XRayParts) do
        if data.Part then
            data.Part.Transparency = data.OriginalTransparency
        end
    end
    XRayParts = {}
end

CreateFeatureButton(FeaturesFrame, "XRayButton", "XRay [OFF]", function()
    XRayEnabled = not XRayEnabled
    local button = FeaturesFrame:FindFirstChild("XRayButton")
    button.Text = XRayEnabled and "XRay [ON]" or "XRay [OFF]"
    
    if XRayEnabled then
        EnableXRay()
    else
        DisableXRay()
    end
end)

-- Instant Respawn
CreateFeatureButton(FeaturesFrame, "RespawnButton", "Instant Respawn", function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
        LocalPlayer.Character.Humanoid.Health = 0
    end
end)

-- Teleport to Enemy
CreateFeatureButton(FeaturesFrame, "TeleportButton", "Teleport to Enemy", function()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and IsEnemy(player) and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 3)
                break
            end
        end
    end
end)

-- Anti-Kick
CreateFeatureButton(FeaturesFrame, "AntiKickButton", "Anti-Kick [OFF]", function()
    AntiKickEnabled = not AntiKickEnabled
    local button = FeaturesFrame:FindFirstChild("AntiKickButton")
    button.Text = AntiKickEnabled and "Anti-Kick [ON]" or "Anti-Kick [OFF]"
    
    if AntiKickEnabled then
        pcall(function()
            local mt = getrawmetatable(game)
            local old = mt.__namecall
            setreadonly(mt, false)
            mt.__namecall = newcclosure(function(self, ...)
                local method = getnamecallmethod()
                if method == "Kick" then
                    return
                end
                return old(self, ...)
            end)
            setreadonly(mt, true)
        end)
    end
end)

-- Update Canvas Sizes
UpdatesFrame.CanvasSize = UDim2.new(0, 0, 0, UpdatesList.AbsoluteContentSize.Y + 10)
UpdatesList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    UpdatesFrame.CanvasSize = UDim2.new(0, 0, 0, UpdatesList.AbsoluteContentSize.Y + 10)
end)

FeaturesFrame.CanvasSize = UDim2.new(0, 0, 0, FeaturesList.AbsoluteContentSize.Y + 10)
FeaturesList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    FeaturesFrame.CanvasSize = UDim2.new(0, 0, 0, FeaturesList.AbsoluteContentSize.Y + 10)
end)

-- Keybinds
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.Z then
        MainFrame.Visible = not MainFrame.Visible
    end
    
    if input.KeyCode == Enum.KeyCode.L then
        AimbotEnabled = not AimbotEnabled
        local button = FeaturesFrame:FindFirstChild("AimbotButton")
        
        if AimbotEnabled then
            button.Text = "Aimbot [ON] - L key"
            EnableAimbot()
        else
            button.Text = "Aimbot [OFF] - L key"
            DisableAimbot()
        end
    end
end)

-- Character Respawn Handler
LocalPlayer.CharacterAdded:Connect(function(char)
    task.wait(0.5)
    
    if SpeedEnabled then
        task.wait(0.5)
        EnableSpeed()
    end
    
    if FlyEnabled then
        task.wait(1)
        EnableFly()
    end
    
    if AimbotEnabled then
        task.wait(0.5)
        EnableAimbot()
    end
    
    if NoClipEnabled then
        task.wait(0.5)
        EnableNoClip()
    end
    
    if ESPEnabled then
        task.wait(0.5)
        for _, player in pairs(Players:GetPlayers()) do
            if player.Character then
                CreateESPForCharacter(player, player.Character)
            end
        end
    end
end)

-- Start with Updates tab
SwitchTab("UpdatesTab")

print("âœ… Leliks Rivals Script v1.0.9 loaded successfully!")
print("ðŸ”‘ Z key = Toggle GUI")
print("ðŸŽ¯ L key = Toggle Aimbot")
